# Parameter Pollution

## Parameter Pollution

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HTTP Parameter Pollution (HPP) Overview

HTTP Parameter Pollution (HPP) je tehnika u kojoj napada캜i manipuli코u HTTP parametrima kako bi promenili pona코anje web aplikacije na nepredvi캠ene na캜ine. Ova manipulacija se vr코i dodavanjem, modifikovanjem ili dupliciranjem HTTP parametara. Efekat ovih manipulacija nije direktno vidljiv korisniku, ali mo쬰 zna캜ajno promeniti funkcionalnost aplikacije na serverskoj strani, sa uo캜ljivim uticajima na klijentskoj strani.

### Example of HTTP Parameter Pollution (HPP)

URL transakcije bankarske aplikacije:

* **Original URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Umetanjem dodatnog `from` parametra:

* **Manipulated URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Transakcija mo쬰 biti pogre코no napla캖ena na `accountC` umesto na `accountA`, pokazuju캖i potencijal HPP-a da manipuli코e transakcijama ili drugim funkcionalnostima kao 코to su resetovanje lozinke, pode코avanja 2FA ili zahtevi za API klju캜em.

#### **Technology-Specific Parameter Parsing**

* Na캜in na koji se parametri analiziraju i prioritizuju zavisi od osnovne web tehnologije, 코to uti캜e na to kako se HPP mo쬰 iskoristiti.
* Alati poput [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) poma쬿 u identifikaciji ovih tehnologija i njihovih pona코anja prilikom analize.

### PHP and HPP Exploitation

**OTP Manipulation Case:**

* **Context:** Mehanizam prijavljivanja koji zahteva jednokratnu lozinku (OTP) je iskori코캖en.
* **Method:** Presretanjem zahteva za OTP koriste캖i alate poput Burp Suite, napada캜i su duplicirali `email` parametar u HTTP zahtevu.
* **Outcome:** OTP, namenjen za prvobitni email, umesto toga je poslat na drugu email adresu navedenu u manipulisanom zahtevu. Ova gre코ka je omogu캖ila neovla코캖en pristup zaobila쬰njem predvi캠ene sigurnosne mere.

Ovaj scenario isti캜e kriti캜an propust u backend-u aplikacije, koji je obradio prvi `email` parametar za generisanje OTP-a, ali je koristio poslednji za isporuku.

**API Key Manipulation Case:**

* **Scenario:** Aplikacija omogu캖ava korisnicima da a쬿riraju svoj API klju캜 putem stranice za pode코avanje profila.
* **Attack Vector:** Napada캜 otkriva da dodavanjem dodatnog `api_key` parametra u POST zahtev mo쬰 manipulisati ishodom funkcije a쬿riranja API klju캜a.
* **Technique:** Koriste캖i alat poput Burp Suite, napada캜 kreira zahtev koji uklju캜uje dva `api_key` parametra: jedan legitimni i jedan zlonameran. Server, obra캠uju캖i samo poslednji slu캜aj, a쬿rira API klju캜 na vrednost koju je naveo napada캜.
* **Result:** Napada캜 dobija kontrolu nad funkcionalno코캖u API-ja rtve, potencijalno pristupaju캖i ili modifikuju캖i privatne podatke bez odobrenja.

Ovaj primer dodatno nagla코ava potrebu za sigurnim rukovanjem parametrima, posebno u funkcijama koje su kriti캜ne kao 코to je upravljanje API klju캜em.

### Parameter Parsing: Flask vs. PHP

Na캜in na koji web tehnologije obra캠uju duple HTTP parametre varira, uti캜u캖i na njihovu podlo쬹ost HPP napadima:

* **Flask:** Usvaja prvu vrednost parametra koja se susre캖e, kao 코to je `a=1` u upitu `a=1&a=2`, prioritizuju캖i inicijalni primerak nad kasnijim duplikatima.
* **PHP (na Apache HTTP Server-u):** Nasuprot tome, prioritizuje poslednju vrednost parametra, biraju캖i `a=2` u datom primeru. Ovo pona코anje mo쬰 nenamerno olak코ati HPP eksploate tako 코to po코tuje manipulisan parametar napada캜a umesto originalnog.

## Parameter pollution by technology

There results were taken from [https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89](https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89)

### PHP 8.3.11 AND Apache 2.4.62 <a href="#id-9523" id="id-9523"></a>

<figure><img src="../.gitbook/assets/image (1255).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l_Pf2JNCYhmfAvfk7UTEbQ.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l_Pf2JNCYhmfAvfk7UTEbQ.jpeg</a></p></figcaption></figure>

1. Ignori코ite sve nakon %00 u imenu parametra.
2. Rukujte name\[] kao niz.
3. \_GET ne zna캜i GET metodu.
4. Preferirajte poslednji parametar.

### Ruby 3.3.5 and WEBrick 1.8.2

<figure><img src="../.gitbook/assets/image (1257).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kKxtZ8qEmgTIMS81py5hhg.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kKxtZ8qEmgTIMS81py5hhg.jpeg</a></p></figcaption></figure>

1. Koristi & i ; delimitere za razdvajanje parametara.
2. Ne prepoznaje name\[].
3. Preferirajte prvi parametar.

### Spring MVC 6.0.23 AND Apache Tomcat 10.1.30 <a href="#dd68" id="dd68"></a>

<figure><img src="../.gitbook/assets/image (1258).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*llG22MF1gPTYZYFVCmCiVw.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*llG22MF1gPTYZYFVCmCiVw.jpeg</a></p></figcaption></figure>

1. POST RequestMapping == PostMapping & GET RequestMapping == GetMapping.
2. POST RequestMapping & PostMapping prepoznaju name[].
3. Preferirajte name ako name i name[] postoje.
4. Konkatenirajte parametre npr. first,last.
5. POST RequestMapping & PostMapping prepoznaju upitni parametar sa Content-Type.

### **NodeJS** 20.17.0 **AND** Express 4.21.0 <a href="#id-6d72" id="id-6d72"></a>

<figure><img src="../.gitbook/assets/image (1259).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JzNkLOSW7orcHXswtMHGMA.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JzNkLOSW7orcHXswtMHGMA.jpeg</a></p></figcaption></figure>

1. Prepoznaje name[].
2. Konkatenirajte parametre npr. first,last.

### GO 1.22.7 <a href="#id-63dc" id="id-63dc"></a>

<figure><img src="../.gitbook/assets/image (1260).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NVvN1N8sL4g_Gi796FzlZA.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NVvN1N8sL4g_Gi796FzlZA.jpeg</a></p></figcaption></figure>

1. NE prepoznaje name[].
2. Preferirajte prvi parametar.

### Python 3.12.6 AND Werkzeug 3.0.4 AND Flask 3.0.3 <a href="#b853" id="b853"></a>

<figure><img src="../.gitbook/assets/image (1261).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Se5467PFFjIlmT3O7KNlWQ.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Se5467PFFjIlmT3O7KNlWQ.jpeg</a></p></figcaption></figure>

1. NE prepoznaje name[].
2. Preferirajte prvi parametar.

### Python 3.12.6 AND Django 4.2.15 <a href="#id-8079" id="id-8079"></a>

<figure><img src="../.gitbook/assets/image (1262).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rf38VXut5YhAx0ZhUzgT8Q.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rf38VXut5YhAx0ZhUzgT8Q.jpeg</a></p></figcaption></figure>

1. NE prepoznaje name[].
2. Preferirajte poslednji parametar.

### Python 3.12.6 AND Tornado 6.4.1 <a href="#id-2ad8" id="id-2ad8"></a>

<figure><img src="../.gitbook/assets/image (1263).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*obCn7xahDc296JZccXM2qQ.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*obCn7xahDc296JZccXM2qQ.jpeg</a></p></figcaption></figure>

1. NE prepoznaje name[].
2. Preferirajte poslednji parametar.

## References

* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)
* [https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89](https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
