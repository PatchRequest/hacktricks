# Parameter Pollution

## Parameter Pollution

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HTTP Parameter Pollution (HPP) Genel BakÄ±ÅŸ

HTTP Parameter Pollution (HPP), saldÄ±rganlarÄ±n HTTP parametrelerini manipÃ¼le ederek bir web uygulamasÄ±nÄ±n davranÄ±ÅŸÄ±nÄ± beklenmedik ÅŸekillerde deÄŸiÅŸtirdiÄŸi bir tekniktir. Bu manipÃ¼lasyon, HTTP parametrelerini ekleyerek, deÄŸiÅŸtirerek veya Ã§oÄŸaltarak yapÄ±lÄ±r. Bu manipÃ¼lasyonlarÄ±n etkisi kullanÄ±cÄ±ya doÄŸrudan gÃ¶rÃ¼nmez, ancak uygulamanÄ±n sunucu tarafÄ±ndaki iÅŸlevselliÄŸini Ã¶nemli Ã¶lÃ§Ã¼de deÄŸiÅŸtirebilir ve istemci tarafÄ±nda gÃ¶zlemlenebilir etkiler yaratabilir.

### HTTP Parameter Pollution (HPP) Ã–rneÄŸi

Bir bankacÄ±lÄ±k uygulamasÄ± iÅŸlem URL'si:

* **Orijinal URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Ek bir `from` parametresi ekleyerek:

* **ManipÃ¼le EdilmiÅŸ URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Ä°ÅŸlem, `accountA` yerine yanlÄ±ÅŸlÄ±kla `accountC`'ye tahsil edilebilir ve bu, HPP'nin iÅŸlemleri veya ÅŸifre sÄ±fÄ±rlama, 2FA ayarlarÄ± veya API anahtarÄ± talepleri gibi diÄŸer iÅŸlevleri manipÃ¼le etme potansiyelini gÃ¶stermektedir.

#### **Teknolojiye Ã–zgÃ¼ Parametre AyrÄ±ÅŸtÄ±rma**

* Parametrelerin nasÄ±l ayrÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ± ve Ã¶nceliklendirildiÄŸi, temel web teknolojisine baÄŸlÄ±dÄ±r ve HPP'nin nasÄ±l istismar edilebileceÄŸini etkiler.
* [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) gibi araÃ§lar, bu teknolojileri ve ayrÄ±ÅŸtÄ±rma davranÄ±ÅŸlarÄ±nÄ± tanÄ±mlamaya yardÄ±mcÄ± olur.

### PHP ve HPP Ä°stismarÄ±

**OTP ManipÃ¼lasyonu Durumu:**

* **BaÄŸlam:** Tek Seferlik Åifre (OTP) gerektiren bir giriÅŸ mekanizmasÄ± istismar edildi.
* **YÃ¶ntem:** Burp Suite gibi araÃ§lar kullanarak OTP talebini kesen saldÄ±rganlar, HTTP isteÄŸindeki `email` parametresini Ã§oÄŸalttÄ±.
* **SonuÃ§:** Ä°lk e-posta iÃ§in tasarlanan OTP, manipÃ¼le edilmiÅŸ istekte belirtilen ikinci e-posta adresine gÃ¶nderildi. Bu hata, amaÃ§lanan gÃ¼venlik Ã¶nlemini aÅŸarak yetkisiz eriÅŸime izin verdi.

Bu senaryo, uygulamanÄ±n arka ucundaki kritik bir gÃ¶zden geÃ§irmeyi vurgular; ilk `email` parametresi OTP Ã¼retimi iÃ§in iÅŸlenirken, teslimat iÃ§in sonuncusu kullanÄ±lmÄ±ÅŸtÄ±r.

**API AnahtarÄ± ManipÃ¼lasyonu Durumu:**

* **Senaryo:** Bir uygulama, kullanÄ±cÄ±larÄ±n profil ayarlarÄ± sayfasÄ± aracÄ±lÄ±ÄŸÄ±yla API anahtarlarÄ±nÄ± gÃ¼ncellemelerine izin verir.
* **SaldÄ±rÄ± VektÃ¶rÃ¼:** Bir saldÄ±rgan, POST isteÄŸine ek bir `api_key` parametresi ekleyerek API anahtarÄ± gÃ¼ncelleme iÅŸlevinin sonucunu manipÃ¼le edebileceÄŸini keÅŸfeder.
* **Teknik:** Burp Suite gibi bir araÃ§ kullanarak, saldÄ±rgan bir geÃ§erli ve bir kÃ¶tÃ¼ niyetli `api_key` parametresi iÃ§eren bir istek hazÄ±rlar. Sunucu, yalnÄ±zca sonuncusunu iÅŸleyerek, API anahtarÄ±nÄ± saldÄ±rganÄ±n saÄŸladÄ±ÄŸÄ± deÄŸere gÃ¼nceller.
* **SonuÃ§:** SaldÄ±rgan, maÄŸdurun API iÅŸlevselliÄŸi Ã¼zerinde kontrol kazanÄ±r ve muhtemelen Ã¶zel verilere yetkisiz eriÅŸim veya deÄŸiÅŸiklik yapabilir.

Bu Ã¶rnek, Ã¶zellikle API anahtarÄ± yÃ¶netimi gibi kritik Ã¶zelliklerde gÃ¼venli parametre iÅŸlemenin gerekliliÄŸini daha da vurgular.

### Parametre AyrÄ±ÅŸtÄ±rma: Flask vs. PHP

Web teknolojilerinin yinelenen HTTP parametrelerini ele alma ÅŸekli, HPP saldÄ±rÄ±larÄ±na karÅŸÄ± duyarlÄ±lÄ±klarÄ±nÄ± etkiler:

* **Flask:** Bir sorgu dizesinde `a=1&a=2` gibi karÅŸÄ±laÅŸtÄ±ÄŸÄ± ilk parametre deÄŸerini benimser, ilk Ã¶rneÄŸi sonraki yinelenenlerden Ã¶ncelikli kÄ±lar.
* **PHP (Apache HTTP Sunucusunda):** Aksine, son parametre deÄŸerini Ã¶nceliklendirir ve verilen Ã¶rnekte `a=2` seÃ§ilir. Bu davranÄ±ÅŸ, saldÄ±rganÄ±n manipÃ¼le ettiÄŸi parametreyi orijinalin Ã¼zerinde tutarak HPP istismarlarÄ±nÄ± istemeden kolaylaÅŸtÄ±rabilir.

## Teknolojiye GÃ¶re Parametre KirliliÄŸi

SonuÃ§lar [https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89](https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89) adresinden alÄ±nmÄ±ÅŸtÄ±r.

### PHP 8.3.11 VE Apache 2.4.62 <a href="#id-9523" id="id-9523"></a>

<figure><img src="../.gitbook/assets/image (1255).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l_Pf2JNCYhmfAvfk7UTEbQ.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l_Pf2JNCYhmfAvfk7UTEbQ.jpeg</a></p></figcaption></figure>

1. Parametre adÄ±nda %00'dan sonrasÄ±nÄ± yok sayÄ±n.
2. name\[]'i dizi olarak ele alÄ±n.
3. \_GET GET YÃ¶ntemini ifade etmez.
4. Son parametreyi tercih edin.

### Ruby 3.3.5 ve WEBrick 1.8.2

<figure><img src="../.gitbook/assets/image (1257).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kKxtZ8qEmgTIMS81py5hhg.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kKxtZ8qEmgTIMS81py5hhg.jpeg</a></p></figcaption></figure>

1. Parametreleri ayÄ±rmak iÃ§in & ve ; ayÄ±rÄ±cÄ±larÄ±nÄ± kullanÄ±r.
2. name\[] tanÄ±nmaz.
3. Ä°lk parametreyi tercih edin.

### Spring MVC 6.0.23 VE Apache Tomcat 10.1.30 <a href="#dd68" id="dd68"></a>

<figure><img src="../.gitbook/assets/image (1258).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*llG22MF1gPTYZYFVCmCiVw.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*llG22MF1gPTYZYFVCmCiVw.jpeg</a></p></figcaption></figure>

1. POST RequestMapping == PostMapping & GET RequestMapping == GetMapping.
2. POST RequestMapping & PostMapping name\[]'i tanÄ±r.
3. name ve name\[] mevcutsa name'i tercih edin.
4. Parametreleri birleÅŸtirin, Ã¶rneÄŸin first,last.
5. POST RequestMapping & PostMapping, Content-Type ile sorgu parametresini tanÄ±r.

### **NodeJS** 20.17.0 **VE** Express 4.21.0 <a href="#id-6d72" id="id-6d72"></a>

<figure><img src="../.gitbook/assets/image (1259).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JzNkLOSW7orcHXswtMHGMA.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JzNkLOSW7orcHXswtMHGMA.jpeg</a></p></figcaption></figure>

1. name\[]'i tanÄ±r.
2. Parametreleri birleÅŸtirir, Ã¶rneÄŸin first,last.

### GO 1.22.7 <a href="#id-63dc" id="id-63dc"></a>

<figure><img src="../.gitbook/assets/image (1260).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NVvN1N8sL4g_Gi796FzlZA.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NVvN1N8sL4g_Gi796FzlZA.jpeg</a></p></figcaption></figure>

1. name\[]'i tanÄ±maz.
2. Ä°lk parametreyi tercih edin.

### Python 3.12.6 VE Werkzeug 3.0.4 VE Flask 3.0.3 <a href="#b853" id="b853"></a>

<figure><img src="../.gitbook/assets/image (1261).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Se5467PFFjIlmT3O7KNlWQ.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Se5467PFFjIlmT3O7KNlWQ.jpeg</a></p></figcaption></figure>

1. name\[]'i tanÄ±maz.
2. Ä°lk parametreyi tercih edin.

### Python 3.12.6 VE Django 4.2.15 <a href="#id-8079" id="id-8079"></a>

<figure><img src="../.gitbook/assets/image (1262).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rf38VXut5YhAx0ZhUzgT8Q.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rf38VXut5YhAx0ZhUzgT8Q.jpeg</a></p></figcaption></figure>

1. name\[]'i tanÄ±maz.
2. Son parametreyi tercih edin.

### Python 3.12.6 VE Tornado 6.4.1 <a href="#id-2ad8" id="id-2ad8"></a>

<figure><img src="../.gitbook/assets/image (1263).png" alt=""><figcaption><p><a href="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*obCn7xahDc296JZccXM2qQ.jpeg">https://miro.medium.com/v2/resize:fit:1100/format:webp/1*obCn7xahDc296JZccXM2qQ.jpeg</a></p></figcaption></figure>

1. name\[]'i tanÄ±maz.
2. Son parametreyi tercih edin.

## Referanslar

* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)
* [https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89](https://medium.com/@0xAwali/http-parameter-pollution-in-2024-32ec1b810f89)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
